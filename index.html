<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<script src="js/functions.js" type="text/javascript"></script>
		<script src="js/js.cookie.js" type="text/javascript"></script>
		<script src="/socket.io/socket.io.js"></script>
		<link rel="stylesheet" type="text/css" href="css/estilo.css"/>
		<script>
			$(function(){
			
				var iosocket = io(); 
				

				iosocket.on('connect', function () {
					
					$('#mural').append('Voce esta conectado.<br>');
	
					iosocket.on('message', function(message) {
						var data = new Date();
		$('#mural').append('['+data.getHours()+':'+data.getMinutes()+':'+data.getSeconds()+'] '+message+'<br>');
					});


					iosocket.on('mudanca-de-nick',function(message){
						$('#mural').append('Servidor: '+message+'<br>');
					});
					
					iosocket.on('motd', function(motd){
						$('#mural').append(motd+'<br>');						
					});
					iosocket.on('me conectei', (data)=>{
						$('#mural').append('Me conectei <br>');					
					});

					//quando se desconecta lanca uma mensagem na interface web no navegador
					iosocket.on('disconnect', function() {
						$('#mural').append('Voce esta desconectado.<br>');
					});
				});
				
				
				$('#mensagem').keypress(function(event) {
					var data = new Date();
					if(event.which == 13) {

						
						event.preventDefault(); 

						iosocket.emit('message', $('#mensagem').val());
						
						$('#mural').append('['+data.getHours()+':'+data.getMinutes()+':'+data.getSeconds()+']: '+$('#mensagem').val()+'<br>');
						
						$('#mensagem').val('');

					}
				});
				$('#enviar').on('click',function(event){

					var data = new Date();
					iosocket.emit('message', $('#mensagem').val());
					
						$('#mural').append('['+data.getHours()+':'+data.getMinutes()+':'+data.getSeconds()+']: '+$('#mensagem').val()+'<br>');

						$('#mensagem').val('');
				});

			});
		
		</script>
		<title>Sala de bate-papo</title>

	</head>


	<body onload="iniciar('mural')">
		
		
		<div class='mural' id="mural"></div>

		<br/>
	
		<div id="status"></div><br/>
		
		
		Mensagem: <input type="text" size="30" id="mensagem"> 
		<input type="button" value="enviar" id='enviar' >

		<select id="mode" onchange="trocarMode('mode')">
			<option value="+i">+i</option>
			<option value="-i">-i</option>
		</select> 
	</body>

</html>
